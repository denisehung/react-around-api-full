(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{26:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),c=n(15),i=n.n(c),s=n(6),r=(n(26),n(20)),l=n(2),u=n(3),p=n.p+"static/media/logo.4e8e0a1d.svg",d=n(0);var j=function(e){return Object(d.jsxs)("header",{className:"header",children:[Object(d.jsx)("img",{src:p,className:"logo",alt:"logo"}),Object(d.jsxs)("div",{className:"header__links",children:[e.loggedIn&&Object(d.jsx)("p",{className:"header__email",children:e.email}),Object(d.jsx)(s.b,{className:"header__link",to:e.link,onClick:e.handleLogout,style:e.loggedIn?{color:"#A9A9A9"}:{},children:e.linkText})]})]})},b=o.a.createContext();var m=function(e){var t,n,a=o.a.useContext(b),c=e.card.owner===(null===a||void 0===a?void 0:a._id),i="card__delete-button ".concat(c?"card__delete-button_visible":"card__delete-button_hidden"),s=null===(t=e.card.likes)||void 0===t?void 0:t.some((function(e){return e===(null===a||void 0===a?void 0:a._id)})),r="card__heart-icon ".concat(s?"card__heart-icon_active":"");return Object(d.jsxs)("div",{className:"card",children:[Object(d.jsx)("button",{className:i,onClick:function(){e.onCardDelete(e.card)}}),Object(d.jsx)("img",{className:"card__image",alt:e.card.name,src:e.card.link,onClick:function(){e.onCardClick(e.card)}}),Object(d.jsxs)("div",{className:"card__textblock",children:[Object(d.jsx)("h2",{className:"card__title",children:e.card.name}),Object(d.jsxs)("div",{className:"card__likes-container",children:[Object(d.jsx)("button",{className:r,onClick:function(){e.onCardLike(e.card)}}),Object(d.jsx)("p",{className:"card__likes-counter",children:null===(n=e.card.likes)||void 0===n?void 0:n.length})]})]})]})};var h=function(e){var t=o.a.useContext(b);return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("main",{className:"content",children:[Object(d.jsxs)("section",{className:"profile",children:[Object(d.jsxs)("div",{className:"profile__details",children:[Object(d.jsxs)("div",{className:"profile__image-container",children:[Object(d.jsx)("div",{className:"profile__image-overlay",onClick:e.onEditAvatarClick}),Object(d.jsx)("div",{className:"profile__image",style:{backgroundImage:"url(".concat(t.avatar,")")}})]}),Object(d.jsxs)("div",{className:"profile__description",children:[Object(d.jsxs)("div",{className:"profile__name-wrapper",children:[Object(d.jsx)("h1",{className:"profile__name",children:t.name}),Object(d.jsx)("button",{className:"profile__edit-button",type:"button","aria-label":"Edit profile",onClick:e.onEditProfileClick})]}),Object(d.jsx)("p",{className:"profile__about",children:t.about})]})]}),Object(d.jsx)("button",{className:"profile__add-button",type:"button","aria-label":"Add image",onClick:e.onAddPlaceClick})]}),Object(d.jsx)("section",{className:"image-grid",children:e.cards.map((function(t){return Object(d.jsx)(m,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})]})})};var f=function(e){var t=o.a.useState(""),n=Object(l.a)(t,2),a=n[0],c=n[1],i=o.a.useState(""),r=Object(l.a)(i,2),u=r[0],p=r[1];return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(j,{linkText:"Sign up",link:"/signup"}),Object(d.jsxs)("div",{className:"form__container",children:[Object(d.jsx)("h2",{className:"form__title",children:"Log in"}),Object(d.jsxs)("form",{className:"form",onSubmit:function(t){t.preventDefault(),e.handleLogin(a,u)},children:[Object(d.jsx)("input",{placeholder:"Email",className:"form__input",type:"email",name:"email",id:"login-email",value:a,onChange:function(e){return c(e.target.value)},required:!0}),Object(d.jsx)("input",{placeholder:"Password",className:"form__input",type:"password",name:"password",id:"login-password",value:u,onChange:function(e){return p(e.target.value)},required:!0}),Object(d.jsx)("button",{className:"form__button",type:"submit","aria-label":"login",children:"Log in"}),Object(d.jsx)(s.b,{to:"/signup",className:"form__link",children:"Not a member yet? Sign up here!"})]})]})]})};var _=function(e){var t=o.a.useState(""),n=Object(l.a)(t,2),a=n[0],c=n[1],i=o.a.useState(""),r=Object(l.a)(i,2),u=r[0],p=r[1];return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(j,{linkText:"Log in",link:"/signin"}),Object(d.jsxs)("div",{className:"form__container",children:[Object(d.jsx)("h2",{className:"form__title",children:"Sign up"}),Object(d.jsxs)("form",{className:"form",onSubmit:function(t){t.preventDefault(),e.handleRegister(a,u)},children:[Object(d.jsx)("input",{placeholder:"Email",className:"form__input",type:"email",name:"email",id:"registration-email",value:a,onChange:function(e){return c(e.target.value)},required:!0}),Object(d.jsx)("input",{placeholder:"Password",className:"form__input",type:"password",name:"password",id:"registration-password",value:u,onChange:function(e){return p(e.target.value)},required:!0}),Object(d.jsx)("button",{className:"form__button",type:"submit","aria-label":"Sign up",children:"Sign up"}),Object(d.jsx)(s.b,{to:"/signin",className:"form__link",children:"Already a member? Log in here!"})]})]})]})};var O=function(){return Object(d.jsx)("footer",{className:"footer",children:Object(d.jsx)("p",{className:"footer__text",children:"\xa9 2021 Around The U.S."})})};var g=function(e){return Object(d.jsx)("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen?"popup_opened":""),onClick:function(t){t.target.classList.contains("popup_opened")&&e.onClose()},children:Object(d.jsxs)("div",{className:"popup__container",children:[Object(d.jsx)("button",{className:"popup__close-button popup__close-button_type_form",type:"button","aria-label":"Close popup",onClick:e.onClose}),Object(d.jsxs)("div",{className:"popup__form",children:[Object(d.jsx)("h2",{className:"popup__container-title",children:e.title}),Object(d.jsxs)("form",{className:"popup__form-main popup__form-main_type_".concat(e.name),name:"form-".concat(e.name),onSubmit:e.onSubmit,children:[e.children,Object(d.jsx)("button",{className:"popup__submit-button",type:"submit","aria-label":"Save changes",children:e.btnText})]})]})]})})};var v=function(e){var t=o.a.useState(null),n=Object(l.a)(t,2),a=n[0],c=n[1],i=o.a.useState(null),s=Object(l.a)(i,2),r=s[0],u=s[1];return Object(d.jsxs)(g,{name:"add-img",title:"New Place",btnText:e.isLoading?"Saving...":"Create",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlaceSubmit({name:a,link:r}),c(""),u("")},isLoading:e.isLoading,children:[Object(d.jsxs)("label",{className:"popup__form-field",children:[Object(d.jsx)("input",{type:"text",className:"popup__input popup__input_type_title",id:"title-input",autoComplete:"off",placeholder:"Title",name:"name",minLength:"1",maxLength:"30",value:a||"",onChange:function(e){c(e.target.value)},required:!0}),Object(d.jsx)("span",{id:"title-input-error",className:"popup__error"})]}),Object(d.jsxs)("label",{className:"popup__form-field",children:[Object(d.jsx)("input",{type:"url",className:"popup__input popup__input_type_img",id:"image-url-input",autoComplete:"off",placeholder:"Image URL",name:"link",value:r||"",onChange:function(e){u(e.target.value)},required:!0}),Object(d.jsx)("span",{id:"image-url-input-error",className:"popup__error"})]})]})};var x=function(e){var t=o.a.useRef();return Object(d.jsx)(g,{name:"avatar",title:"Change profile picture",btnText:e.isLoading?"Saving...":"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},isLoading:e.isLoading,children:Object(d.jsxs)("label",{className:"popup__form-field",children:[Object(d.jsx)("input",{type:"url",className:"popup__input popup__input_type_img",id:"avatar-url-input",autoComplete:"off",placeholder:"Image URL",name:"link",ref:t,required:!0}),Object(d.jsx)("span",{id:"avatar-url-input-error",className:"popup__error"})]})})};var C=function(e){var t=o.a.useContext(b),n=o.a.useState(t.name),a=Object(l.a)(n,2),c=a[0],i=a[1],s=o.a.useState(t.about),r=Object(l.a)(s,2),u=r[0],p=r[1];return o.a.useEffect((function(){i(t.name),p(t.about)}),[t,e.isOpen]),Object(d.jsxs)(g,{name:"edit",title:"Edit profile",btnText:e.isLoading?"Saving...":"Save changes",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:u})},isLoading:e.isLoading,children:[Object(d.jsxs)("label",{className:"popup__form-field",children:[Object(d.jsx)("input",{type:"text",className:"popup__input popup__input_type_name",id:"name-input",autoComplete:"off",placeholder:"Name",name:"username",minLength:"2",maxLength:"40",value:c||"",onChange:function(e){i(e.target.value)},required:!0}),Object(d.jsx)("span",{id:"name-input-error",className:"popup__error"})]}),Object(d.jsxs)("label",{className:"popup__form-field",children:[Object(d.jsx)("input",{type:"text",className:"popup__input popup__input_type_about",id:"about-input",autoComplete:"off",placeholder:"About me",name:"userjob",minLength:"2",maxLength:"200",value:u||"",onChange:function(e){p(e.target.value)},required:!0}),Object(d.jsx)("span",{id:"about-input-error",className:"popup__error"})]})]})};var k=function(e){return Object(d.jsx)(g,{name:"delete",title:"Are you sure?",btnText:e.isLoading?"Deleting...":"Yes",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onCardDelete(e.card)},isLoading:e.isLoading})};var N=function(e){return Object(d.jsx)("div",{className:"popup popup_type_image ".concat(e.card&&"popup_opened"),onClick:function(t){t.target.classList.contains("popup_opened")&&e.onClose()},children:Object(d.jsxs)("div",{className:"popup__wrapper",children:[Object(d.jsx)("button",{className:"popup__close-button popup__close-button_type_image",type:"button","aria-label":"Close popup",onClick:e.onClose}),Object(d.jsx)("img",{src:e.card?e.card.link:null,alt:e.card?e.card.name:null,className:"popup__image"}),Object(d.jsx)("figcaption",{className:"popup__caption",children:e.card?e.card.name:""})]})})},y=n(14),S=n(21),L=["children","loggedIn"];var A=function(e){var t=e.children,n=e.loggedIn,a=Object(S.a)(e,L);return Object(d.jsx)(u.b,Object(y.a)(Object(y.a)({},a),{},{children:n?t:Object(d.jsx)(u.a,{to:"/signin"})}))},T=n.p+"static/media/success-icon.1b6082f8.svg",U=n.p+"static/media/failure-icon.df8eddf6.svg";var E=function(e){return Object(d.jsx)("div",{className:"popup popup_type_tooltip ".concat(e.isOpen?"popup_opened":""),onClick:function(t){t.target.classList.contains("popup_opened")&&e.onClose()},children:Object(d.jsxs)("div",{className:"popup__container",children:[Object(d.jsx)("button",{className:"popup__close-button popup__close-button_type_form",type:"button","aria-label":"Close popup",onClick:e.onClose}),Object(d.jsxs)("div",{className:"popup__form popup__form_type_tooltip",children:[Object(d.jsx)("img",{src:e.isRegistered?T:U,className:"popup__tooltip-icon",alt:"success icon"}),Object(d.jsx)("h2",{className:"popup__tooltip-text",children:e.isRegistered?"Success! You have now been registered.":"Oops, something went wrong! Please try again."})]})]})})},w=n(18),I=n(19),P=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(w.a)(this,e),this._baseUrl=n,this._headers=a}return Object(I.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getInitialCards",value:function(e){var t=this;return fetch(this._baseUrl+"/cards",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return t._checkResponse(e)}))}},{key:"getUserInfo",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return t._checkResponse(e)}))}},{key:"setUserInfo",value:function(e,t){var n=this,a=e.name,o=e.about;return fetch(this._baseUrl+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"PATCH",body:JSON.stringify({name:a,about:o})}).then((function(e){return n._checkResponse(e)}))}},{key:"addCard",value:function(e,t){var n=this,a=e.name,o=e.link;return fetch(this._baseUrl+"/cards",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"POST",body:JSON.stringify({name:a,link:o})}).then((function(e){return n._checkResponse(e)}))}},{key:"removeCard",value:function(e,t){var n=this;return fetch(this._baseUrl+"/cards/"+e,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"DELETE"}).then((function(e){return n._checkResponse(e)}))}},{key:"addLike",value:function(e,t){var n=this;return fetch(this._baseUrl+"/cards/likes/"+e,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"PUT"}).then((function(e){return n._checkResponse(e)}))}},{key:"removeLike",value:function(e,t){var n=this;return fetch(this._baseUrl+"/cards/likes/"+e,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"DELETE"}).then((function(e){return n._checkResponse(e)}))}},{key:"setUserAvatar",value:function(e,t){var n=this;return fetch(this._baseUrl+"/users/me/avatar",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"PATCH",body:JSON.stringify({avatar:e})}).then((function(e){return n._checkResponse(e)}))}}]),e}())({baseUrl:"https://react-around-server.herokuapp.com"}),R="https://react-around-server.herokuapp.com";function D(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}var B=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),i=Object(l.a)(c,2),s=i[0],p=i[1],m=Object(a.useState)(!1),g=Object(l.a)(m,2),y=g[0],S=g[1],L=Object(a.useState)(!1),T=Object(l.a)(L,2),U=T[0],w=T[1],I=Object(a.useState)(!1),B=Object(l.a)(I,2),q=B[0],z=B[1],F=Object(a.useState)(null),J=Object(l.a)(F,2),H=J[0],Y=J[1],G=Object(a.useState)([]),M=Object(l.a)(G,2),K=M[0],Q=M[1],V=Object(a.useState)(null),W=Object(l.a)(V,2),X=W[0],Z=W[1],$=Object(a.useState)({}),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(!1),oe=Object(l.a)(ae,2),ce=oe[0],ie=oe[1],se=Object(a.useState)(!1),re=Object(l.a)(se,2),le=re[0],ue=re[1],pe=Object(a.useState)(!1),de=Object(l.a)(pe,2),je=de[0],be=de[1],me=Object(a.useState)(""),he=Object(l.a)(me,2),fe=he[0],_e=he[1],Oe=Object(a.useState)(localStorage.getItem("jwt")),ge=Object(l.a)(Oe,2),ve=ge[0],xe=ge[1],Ce=Object(u.g)();function ke(){S(!1),o(!1),p(!1),w(!1),be(!1),Z(null),Y(null)}function Ne(){localStorage.removeItem("jwt"),ie(!1),_e(""),Ce.push("/signin"),console.log("Logged out!")}return Object(a.useEffect)((function(){var e=function(e){"Escape"===e.key&&ke()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]),Object(a.useEffect)((function(){ve&&function(e){return fetch("".concat(R,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return D(e)})).then((function(e){return e}))}(ve).then((function(e){ie(!0),_e(e.user.email),Ce.push("/")})).catch((function(e){return console.log(e)}))}),[Ce,ve]),Object(a.useEffect)((function(){P.getUserInfo(ve).then((function(e){ne(e.user),console.log("USER",e.user)})).catch((function(e){return console.log(e)}))}),[ve]),Object(a.useEffect)((function(){P.getInitialCards(ve).then((function(e){Q(e.data),console.log("CARDS",e.data)})).catch((function(e){return console.log(e)}))}),[ve]),Object(d.jsxs)(b.Provider,{value:te,children:[Object(d.jsxs)(u.d,{children:[Object(d.jsxs)(A,{path:"/main",loggedIn:ce,children:[Object(d.jsx)(j,{linkText:"Log out",link:"/signin",handleLogout:Ne,loggedIn:ce,email:fe}),Object(d.jsx)(h,{handleLogout:Ne,component:h,onCardClick:function(e){Y(e)},onEditProfileClick:function(){o(!0)},onAddPlaceClick:function(){p(!0)},onEditAvatarClick:function(){S(!0)},onCardLike:function(e){e.likes.some((function(e){return e===te._id}))?P.removeLike(e._id,ve).then((function(t){Q((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)})):P.addLike(e._id,ve).then((function(t){Q((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){w(!0),Z(e),z(!1)},onClose:ke,cards:K,email:fe}),Object(d.jsx)(O,{})]}),Object(d.jsx)(u.b,{path:"/signin",children:Object(d.jsx)(f,{handleLogin:function(e,t){e&&t&&function(e,t){return fetch("".concat(R,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return D(e)})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),console.log(e.token),e})).catch((function(e){return console.log(e)}))}(e,t).then((function(t){t.token&&(localStorage.setItem("jwt",t.token),xe(t.token),ie(!0),_e(e),Ce.push("/main"))})).catch((function(e){console.log(e)}))}})}),Object(d.jsx)(u.b,{path:"/signup",children:Object(d.jsx)(_,{handleRegister:function(e,t){e&&t&&function(e,t){return fetch("".concat(R,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return D(e)})).then((function(e){return e})).catch((function(e){return console.log(e)}))}(e,t).then((function(e){e?(ue(!0),be(!0),Ce.push("/signin")):(ue(!1),be(!0))})).catch((function(e){console.log(e)}))}})}),Object(d.jsx)(u.b,{exact:!0,path:"/",children:ce?Object(d.jsx)(u.a,{to:"/main"}):Object(d.jsx)(u.a,{to:"/signin"})})]}),Object(d.jsx)(E,{isOpen:je,onClose:ke,isRegistered:le}),Object(d.jsx)(v,{isLoading:q,isOpen:s,onClose:ke,onAddPlaceSubmit:function(e){var t=e.name,n=e.link;z(!0),P.addCard({name:t,link:n},ve).then((function(e){Q([e.data].concat(Object(r.a)(K))),ke()})).catch((function(e){console.log(e)})).finally((function(){z(!1)}))}}),Object(d.jsx)(x,{isLoading:q,isOpen:y,onClose:ke,onUpdateAvatar:function(e){var t=e.avatar;z(!0),P.setUserAvatar(t,ve).then((function(e){ne(e.data),ke()})).catch((function(e){console.log(e)})).finally((function(){z(!1)}))}}),Object(d.jsx)(C,{isLoading:q,isOpen:n,onClose:ke,onUpdateUser:function(e){var t=e.name,n=e.about;z(!0),P.setUserInfo({name:t,about:n},ve).then((function(e){ne(e.data),ke()})).catch((function(e){console.log(e)})).finally((function(){z(!1)}))}}),Object(d.jsx)(k,{isLoading:q,isOpen:U,onClose:ke,onCardDelete:function(e){z(!0),P.removeCard(e._id,ve).then((function(){Q((function(t){return t.filter((function(t){return t._id!==e._id}))})),ke()})).catch((function(e){console.log(e)})).finally((function(){z(!1)}))},card:X}),Object(d.jsx)(N,{card:H,onClose:ke})]})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),c(e),i(e)}))};i.a.render(Object(d.jsx)(o.a.StrictMode,{children:Object(d.jsx)(s.a,{children:Object(d.jsx)(B,{})})}),document.getElementById("root")),q()}},[[36,1,2]]]);
//# sourceMappingURL=main.2069324d.chunk.js.map